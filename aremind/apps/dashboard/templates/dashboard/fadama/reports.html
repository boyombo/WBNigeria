{% extends "dashboard/fadama/base.html" %}

{% block content %}
    {{ block.super }}

<script>

if (!window.console) {
    window.console = {
        log: function () { }
    };
}

$(document).ready(function() {
    detail_report_init();
});

charts_init = false;
google.load('visualization', '1', { packages: ['corechart'] });

function detail_report_init() {
    var model = new FadamaDetailViewModel();
    ko.applyBindings(model);

    google.setOnLoadCallback(function() {
        model.active_month(model.active_month());
        charts_init = true;
    });
}
</script>

    <div class="row-fluid">
        <table class="date-control" style="float: right;">
            <tr>
                <td style="width: 4em; vertical-align: top; text-align: left;">
                    <a href="#" data-bind="click: prevmonth, style: { color: monthly().indexOf(active_month()) == 0 ? '#888' : '' }">Prev</a>
                  </td>
                  <td class="month" style="width: 8em; vertical-align: top; text-align: center;">
                    <p data-bind="text: active_month() ? active_month().month_label() : ''"></p>
                  </td>
                  <td style="width: 4em; vertical-align: top; text-align: right;">
                    <a href="#" data-bind="click: nextmonth, style: { color: monthly().indexOf(active_month()) == monthly().length - 1 ? '#888' : '' }">Next</a>
                </td>
            </tr>
        </table>

        <div class="span8">
            <form id="detail-filter" class="form-inline filter-form">
                <label>Feedback on</label>
                <select data-bind="value: active_metric" id="feedback">
                    <option value="all">All</option>
                    <option value="satisf">Overall Satisfaction</option>
                    <option value="serviceprovider">Service Providers</option>
                    <option value="people">People from Fadama</option>
                    <option value="land">Land Issues</option>
                    <option value="info">Information Issues</option>
                    <option value="ldp">LDP Approval</option>
                    <option value="financial">Financial Issues</option>
                </select>
                <label>in</label>
                <select data-bind="options: facilities, value: active_facility, optionsText: 'name'" id="location">
                </select>
            </form>
        </div>
    </div>

    <div class="row-fluid" data-bind="visible: active_metric() != 'all'">
        <div class="span8">
            <h3>Reports by Month</h3>
            <p>
                <div id="multi-month-chart" data-bind="historicalchart: active_month" class="chart"></div>
            </p>
        </div>
        <div class="span4">
            <h3>Patients reported&hellip;</h3>
            <p>
                <div id="multi-month-chart" data-bind="currentchart: active_month" class="chart"></div>
            </p>
        </div>
    </div>

    <div class="row-fluid" data-bind="visible: active_metric() == 'all'">
        <div class="span12">
            {% include "dashboard/_map.html" %}
        </div>
    </div>

    <div class="row-fluid">
        <div class="span12">
            <span class="large">Detailed Reports</span>
            {% include "dashboard/_table_filter.html" %}
        </div>
    </div>

    <div class="row-fluid">
        <div class="span12">

        </div>
    </div>
{% endblock content %}

